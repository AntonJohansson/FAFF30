% Laborationsmall.tex
\documentclass[a4paper]{article}

\usepackage[swedish]{babel}
\usepackage[utf8x]{inputenc}

\usepackage{multicol}
\usepackage[vmargin=3cm,hmargin=2cm]{geometry}
\usepackage{parskip}
\usepackage[runin]{abstract}
\renewcommand{\abstitleskip}{0mm}

\usepackage{hyperref}
\usepackage{amsmath}
\usepackage{lmodern}
\usepackage[T1]{fontenc}
\usepackage{pgfplots}
\pgfplotsset{compat=1.13}
\usetikzlibrary{decorations.pathreplacing}
\usetikzlibrary{arrows.meta}
\usepackage{pgfplotstable}
\usepackage{placeins}
\usepackage{siunitx}
\usepackage[numbered,framed]{matlab-prettifier}

\lstset{
	style              = Matlab-editor,
	basicstyle         = \mlttfamily,
	mlshowsectionrules = true,
}

\addto\extrasswedish{%
	\def\equationautorefname{Ekvation}%
	\def\figureautorefname{Figur}%
	\def\tableautorefname{Tabell}%
	\def\sectionautorefname{Rubrik}%
	\def\subsectionautorefname{Underrubrik}%
	\def\pageautorefname{Sida}%
}

\begin{filecontents}{fresnelc.txt}
   -0.4984
   -0.4599
   -0.4308
   -0.4182
   -0.4248
   -0.4489
   -0.4849
   -0.5247
   -0.5596
   -0.5821
   -0.5878
   -0.5756
   -0.5481
   -0.5108
   -0.4711
   -0.4362
   -0.4126
   -0.4043
   -0.4125
   -0.4358
   -0.4701
   -0.5097
   -0.5482
   -0.5799
   -0.5999
   -0.6056
   -0.5963
   -0.5734
   -0.5403
   -0.5014
   -0.4617
   -0.4262
   -0.3992
   -0.3836
   -0.3810
   -0.3917
   -0.4142
   -0.4461
   -0.4839
   -0.5239
   -0.5623
   -0.5957
   -0.6210
   -0.6364
   -0.6407
   -0.6338
   -0.6163
   -0.5898
   -0.5563
   -0.5182
   -0.4782
   -0.4388
   -0.4024
   -0.3711
   -0.3466
   -0.3299
   -0.3218
   -0.3226
   -0.3319
   -0.3491
   -0.3734
   -0.4036
   -0.4384
   -0.4763
   -0.5160
   -0.5561
   -0.5954
   -0.6327
   -0.6671
   -0.6978
   -0.7241
   -0.7456
   -0.7620
   -0.7731
   -0.7789
   -0.7795
   -0.7752
   -0.7661
   -0.7527
   -0.7351
   -0.7140
   -0.6895
   -0.6622
   -0.6323
   -0.6003
   -0.5665
   -0.5312
   -0.4947
   -0.4571
   -0.4188
   -0.3799
   -0.3406
   -0.3009
   -0.2610
   -0.2210
   -0.1809
   -0.1407
   -0.1005
   -0.0603
   -0.0201
    0.0201
    0.0603
    0.1005
    0.1407
    0.1809
    0.2210
    0.2610
    0.3009
    0.3406
    0.3799
    0.4188
    0.4571
    0.4947
    0.5312
    0.5665
    0.6003
    0.6323
    0.6622
    0.6895
    0.7140
    0.7351
    0.7527
    0.7661
    0.7752
    0.7795
    0.7789
    0.7731
    0.7620
    0.7456
    0.7241
    0.6978
    0.6671
    0.6327
    0.5954
    0.5561
    0.5160
    0.4763
    0.4384
    0.4036
    0.3734
    0.3491
    0.3319
    0.3226
    0.3218
    0.3299
    0.3466
    0.3711
    0.4024
    0.4388
    0.4782
    0.5182
    0.5563
    0.5898
    0.6163
    0.6338
    0.6407
    0.6364
    0.6210
    0.5957
    0.5623
    0.5239
    0.4839
    0.4461
    0.4142
    0.3917
    0.3810
    0.3836
    0.3992
    0.4262
    0.4617
    0.5014
    0.5403
    0.5734
    0.5963
    0.6056
    0.5999
    0.5799
    0.5482
    0.5097
    0.4701
    0.4358
    0.4125
    0.4043
    0.4126
    0.4362
    0.4711
    0.5108
    0.5481
    0.5756
    0.5878
    0.5821
    0.5596
    0.5247
    0.4849
    0.4489
    0.4248
    0.4182
    0.4308
    0.4599
    0.4984
\end{filecontents}
\begin{filecontents}{fresnels.txt}
   -0.4205
   -0.4304
   -0.4576
   -0.4953
   -0.5346
   -0.5663
   -0.5832
   -0.5818
   -0.5626
   -0.5298
   -0.4903
   -0.4524
   -0.4235
   -0.4093
   -0.4122
   -0.4316
   -0.4638
   -0.5028
   -0.5418
   -0.5743
   -0.5948
   -0.6002
   -0.5898
   -0.5654
   -0.5308
   -0.4913
   -0.4524
   -0.4196
   -0.3973
   -0.3881
   -0.3932
   -0.4116
   -0.4411
   -0.4779
   -0.5179
   -0.5565
   -0.5895
   -0.6138
   -0.6269
   -0.6278
   -0.6165
   -0.5943
   -0.5633
   -0.5263
   -0.4865
   -0.4470
   -0.4110
   -0.3809
   -0.3589
   -0.3463
   -0.3437
   -0.3512
   -0.3681
   -0.3932
   -0.4249
   -0.4613
   -0.5006
   -0.5407
   -0.5798
   -0.6160
   -0.6479
   -0.6744
   -0.6945
   -0.7077
   -0.7136
   -0.7123
   -0.7041
   -0.6893
   -0.6686
   -0.6427
   -0.6123
   -0.5784
   -0.5417
   -0.5031
   -0.4634
   -0.4232
   -0.3832
   -0.3441
   -0.3063
   -0.2701
   -0.2359
   -0.2041
   -0.1746
   -0.1477
   -0.1234
   -0.1016
   -0.0824
   -0.0657
   -0.0513
   -0.0392
   -0.0291
   -0.0208
   -0.0143
   -0.0093
   -0.0057
   -0.0031
   -0.0015
   -0.0005
   -0.0001
   -0.0000
    0.0000
    0.0001
    0.0005
    0.0015
    0.0031
    0.0057
    0.0093
    0.0143
    0.0208
    0.0291
    0.0392
    0.0513
    0.0657
    0.0824
    0.1016
    0.1234
    0.1477
    0.1746
    0.2041
    0.2359
    0.2701
    0.3063
    0.3441
    0.3832
    0.4232
    0.4634
    0.5031
    0.5417
    0.5784
    0.6123
    0.6427
    0.6686
    0.6893
    0.7041
    0.7123
    0.7136
    0.7077
    0.6945
    0.6744
    0.6479
    0.6160
    0.5798
    0.5407
    0.5006
    0.4613
    0.4249
    0.3932
    0.3681
    0.3512
    0.3437
    0.3463
    0.3589
    0.3809
    0.4110
    0.4470
    0.4865
    0.5263
    0.5633
    0.5943
    0.6165
    0.6278
    0.6269
    0.6138
    0.5895
    0.5565
    0.5179
    0.4779
    0.4411
    0.4116
    0.3932
    0.3881
    0.3973
    0.4196
    0.4524
    0.4913
    0.5308
    0.5654
    0.5898
    0.6002
    0.5948
    0.5743
    0.5418
    0.5028
    0.4638
    0.4316
    0.4122
    0.4093
    0.4235
    0.4524
    0.4903
    0.5298
    0.5626
    0.5818
    0.5832
    0.5663
    0.5346
    0.4953
    0.4576
    0.4304
    0.4205
\end{filecontents}

\pgfplotstableset{
    create on use/Y/.style={create col/copy column from table={fresnels.txt}{0}}
}

\usepackage{graphicx}
%\usepackage{subcaption}
\usepackage{ccaption}
\captionnamefont{\it}
\captiontitlefont{\it}

% Hack för att få komma istället för punkt i matematiska uttryck
% $3.141592$ blir 3,141592
% Om man använder komma direkt får man ett litet oönskat mellanrum:
% $3,141592$ blir 3, 141592
\DeclareMathSymbol{,}{\mathpunct}{letters}{"3B}
\DeclareMathSymbol{.}{\mathord}{letters}{"3B}
\DeclareMathSymbol{\decimal}{\mathord}{letters}{"3A}

% Kommando för att få icke-kursiva enheter i matematiska uttryck
% $10\unit{km}$ blir 10 km
\newcommand{\unit}[1]{\ensuremath{\,\mathrm{#1}}}

\usepackage{lastpage}
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf[C]{\thepage}
\fancyhead[C]{Våglära och optik, FAFF30}
\fancyhead[R,L]{}
\fancypagestyle{plain}{
  \fancyhead{}
}
%\setcounter{secnumdepth}{-1} % Stänger av numrering.

\title{Laborationen ”Ljusets diffraktion”}
\author{Johan Boström\\Anton Johansson\\Lunds Universitet}

\makeatletter
%\renewcommand{\section}{\@startsection
%{section}%                   % the name
%{1}%                         % the level
%{0mm}%                       % the indent
%{-\baselineskip}%            % the before skip
%{0.5mm}%          % the after skip
%{\normalfont\bfseries}} % the style
%\renewcommand{\sectionmark}[1]{ }
%\renewcommand{\thesection}{}

\renewcommand*\maketitle{
  {
    \begin{center}
      {\huge\bfseries \@title}\\
      \vspace{5mm}
      {\large \@author}
    \end{center}
    \vspace{2mm}
  }
}
\makeatother

\begin{document}
\maketitle

\renewcommand{\abstractname}{Abstract} % Om vi vill ha titeln till abstracten på engelska.

%\begin{abstract}
  %Kort beskrivning  av resultaten (5-10  rader). Det ska inte  vara en innehållsbeskrivning (först gör vi det, sen använder vi den metoden, och så jämför vi det med de där tidigare kända resultaten, etc) utan vara   koncentrerat  till   ”resultatet”,   vad   man  kommer fram till. Sammanfattningen är uppsatsens löpsedel. Den ska vara kort och kärnfull och locka läsare genom att  effektivt göra klart vad det är man uppnår genom att läsa rapporten.
  
%\end{abstract}

\vspace{2mm}

\hspace{-3mm}
\begin{tabular}{ll}
Laborationen genomförd: &	2017-05-04 \\
%Rapporten kamratgranskad: &	2013-xx-xx \\
Lämnad till handledare: &	2017-xx-xx \\
\end{tabular}

\vspace{3mm}

\section{Inledning}
  %Preliminär beskrivning av uppgiften  i lättfattliga termer. Bakgrunden till att man intresserar sig för detta problem, denna uppgift. Hur den ingår i ett större sammanhang.

%  En detaljerad beskrivning av vad det hela går ut på, och vad exakt din uppgift   i    sammanhanget   är.    Utrustningsförutsättningar.   Det
%  ursprungligen avsedda målet. Även den i ämnet oinsatte ska ha en ärlig
%  chans att förstå de stora dragen.
%
%  Beskrivning av hur rapporten är uppbyggd, för att göra det möjligt för
%  läsaren att förstå vad som  pågår, ge läsaren rätta förväntningar, och
%  för  att  underlätta direktåtkomst  av  för  den individuelle  läsaren
%  särskilt intressanta delar.

Diffraktion förekommer ofta inom olika områden då vågor förekommer, men ofta är det just ljus man är intresserad av. För att kunna undersöka mera komplexa fenomen måste man ha en god förståelse av de grundläggande principerna bakom och därför syftar den här rapporten till att översiktligt undersöka en mängd olika situationer då diffraktion uppstår och koppla dem till deras teoretiska beskrivningar. Både praktiska experiment med en laser och datorsimuleringar utfördes och jämfördes.

\section{Teori}

\subsection{Diffraktion}

\FloatBarrier

\pgfmathsetmacro{\numSources}{4}
\pgfmathsetmacro{\numWaves}{10}
\pgfmathsetmacro{\numIncoming}{8}
\pgfmathsetmacro{\wavesDist}{0.25}

När en våg passerar en spalt eller ett annat objekt som blockerar ljuset i vissa områden kommer den enligt Huygens princip att uppföra sig som om det funnits en mängd punktkällor utspridda över hela ytan där objektet är genomskinligt. Vågorna som bildas från dessa kommer därefter att interferera med varandra. Detta demonstreras i \autoref{fig:singleInterference} med kollimerat infallande ljus approximerat med endast \numSources~punktkällor.

\begin{figure}[ht]
	\centering
	\begin{tikzpicture}
	\draw[line width=0.75mm] (0, {1 + \wavesDist*\numWaves}) -- (0, 0.5); % Draw the top half of the slit.
	\draw (0, 0.5) -- (0, -0.5); % Draw the wavefront inside the slit.
	\draw[line width=0.75mm] (0, -0.5) -- (0, {-1 - \wavesDist*\numWaves}); % Draw the lower half of the slit.
	\foreach \incoming in {1,...,\numIncoming} % Draw all incoming wavefronts.
	{
		\draw ({-\incoming*\wavesDist}, {-0.5 - \wavesDist*\numWaves}) -- ({-\incoming*\wavesDist}, {0.5 + \wavesDist*\numWaves});
	}
	\foreach \source in {1,...,\numSources} % For each source
	{
		\node[circle,fill=black,inner sep=0,minimum size=5] at (0, {(\source-1)/(\numSources-1) - 0.5}) {}; % Draw the source
		\foreach \waveIdx in {1,...,\numWaves}
		{ % and numWaves waves spaced with wavesDist
			\draw (0, {(\source-1)/(\numSources-1) - 0.5 - \wavesDist*\waveIdx}) arc [radius={\wavesDist*\waveIdx}, start angle=-90, end angle=90];
		}
	}
	\end{tikzpicture}
	\caption{Demonstration av diffraktion i enkelspalt då vågorna infaller från vänster. Där vågorna överlappar interfererar de konstruktivt, medan det är svårare att se när de interfererar destruktivt. Förutom huvudmaximat rakt åt höger syns även ett ytterliggare maximum i vardera riktningen. I en riktig spalt blir det oändligt många punktkällor som måste adderas ihop i en integral.}
	\label{fig:singleInterference}
\end{figure}

För att summera bidragen från de oändligt många punktkällorna används Fresnel-Kirchhoffs integral \cite[p.~330]{pearsonIntroOpt}

\begin{equation}
	E_P = \frac{-i k E_S}{2\pi} e^{-i \omega t} \iint\limits_{\mathrm{Objektet}} {F(\theta)\frac{e^{i k (r + r')}}{r r'} d A}
	\label{eq:frKirInt}
\end{equation}

där $E_P$ är det elektriska fältet på skärmen med avstånder $r$ från den infinitesimala arean $d A$ på objektet. På samma sätt är $E_S$ det elektriska fältet av punktkällan och $r'$ dess avstånd till $d A$. $k$ är vågtalet, $\omega$ är vinkelfrekvensen och $F(\theta) = \frac{1 + \cos\theta}{2}$ är en obliquity-faktor som är nära ett då vågen passerar rakt igenom objektet men avtar för högra vinklar och $\theta$ är vinkeln mot den optiska axeln.

\subsubsection{Fraunhoferdiffraktion}

När både källan och skärmen är långt borta från objektet varierar både $r$ och $r'$ i \eqref{eq:frKirInt} mycket lite över objektets area och kan flyttas ut ur integralen. Samtidigt blir obliquity-faktorn nästan konstant då $\theta$ är nära noll och även den kan tas ut ur integralen. Integralen kan då förenklas till \cite[p.~331]{pearsonIntroOpt}

\begin{equation}
	E_P = C_0 e^{-i \omega t} \iint\limits_{\mathrm{Objektet}} {e^{i k r} dA}
	\label{eq:fraunhofer}
\end{equation}

där $C_0$ är en konstant. Om positionen på skärmen betecknas med ortsvektorn $\boldsymbol{p}$ och positionen på objektet med $\boldsymbol{p'}$ blir

\begin{equation}
	r = \sqrt{(\boldsymbol{p} - \boldsymbol{p'})\cdot(\boldsymbol{p} - \boldsymbol{p'})} = \sqrt{\boldsymbol{p}\cdot\boldsymbol{p} - 2 \boldsymbol{p}\cdot\boldsymbol{p'} + \boldsymbol{p'}\cdot\boldsymbol{p'}}\text{.}
\end{equation}

Man kan nu bryta ut $|\boldsymbol{p}|$

\begin{equation}
r = |\boldsymbol{p}|\sqrt{1 - \frac{2\boldsymbol{p}\cdot\boldsymbol{p'}}{|\boldsymbol{p}|^2} + \left(\frac{|\boldsymbol{p'}|}{|\boldsymbol{p}|}\right)^2}
\end{equation}

och då $|\boldsymbol{p'}|\ll|\boldsymbol{p}|$ blir $\left(\frac{|\boldsymbol{p'}|}{|\boldsymbol{p}|}\right)^2\approx 0$ och man kan utveckla kvadratroten till

\begin{equation}
	r = |\boldsymbol{p}|\left( 1 - \frac{\boldsymbol{p}\cdot\boldsymbol{p'}}{|\boldsymbol{p}|^2} \right) = |\boldsymbol{p}| - \left(\frac{\boldsymbol{p}}{|\boldsymbol{p}|}\right)\cdot\boldsymbol{p'}\text{.}
\end{equation}

Här är $|\boldsymbol{p}|$ konstant i integralen i \eqref{eq:fraunhofer} och kan absorberas i konstanten. Med beteckningen $\boldsymbol{k} = k \frac{\boldsymbol{p}}{|\boldsymbol{p}|}$ kan \eqref{eq:fraunhofer} skrivas \cite{labManual}

\begin{equation}
	E_P = C_1 e^{-i \omega t} \iint\limits_{\mathrm{Objektet}} {e^{-i \boldsymbol{k}\cdot\boldsymbol{p'}} dA}\text{.}
	\label{eq:fraunFT}
\end{equation}

Nu är integralen exakt definitionen av en tvådimensionell Fouriertransform av en funktion som är ett där objektet släpper igenom ljus och noll där den inte gör det. \cite{labManual}

Ett viktigt specialfall är ett spaltsystem där alla spalter har samma bredd och samma avstånd till sina grannar. Då kan \eqref{eq:fraunFT} lösas exakt och intensitetsfördelningen för $N$ spalter kan skrivas \cite[p.~301]{pearsonIntroOpt} \cite{labManual}

\begin{equation}
	I = I_0 \left(\frac{\sin\beta}{\beta}\right)^2 \left(\frac{\sin N\gamma}{\sin\gamma}\right)^2
	\label{eq:diffGrating}
\end{equation}

där $\beta = \frac{\pi}{\lambda} b \sin\theta$ och $\gamma = \frac{\pi}{\lambda} d \sin\theta$ där $\lambda$ är våglängden för ljuset, $b$ är spaltstorleken och $d$ är avståndet från mitten av en spalt till mitten av nästa.

\subsubsection{Fresneldiffraktion}

Då man inte kan göra de approximationer som leder fram till Fraunhoferdiffraktion måste man lösa \eqref{eq:frKirInt} direkt, vilket bara går analytiskt för ett fåtal specialfall. Två sådana specialfall behandlas i \cite{pearsonIntroOpt}: objekt med cirkulär samt rektangulär symmetri. Ytterliggare beräknas integralen för en rektangulär öppning då variationerna av obliquity-faktorn och produkten $r r'$ försummas.

Ett viktigt koncept inom Fresneldiffraktion är Fresnelzoner. Då olika delar av ett objekt har olika avstånd till ljuskällan kommer inkommande ljuset ha rört sig olika sträckor och därmed ha olika fas när de når objektet. Detta demonstreras i \autoref{fig:fresnelZones}. Allt ljus som träffar precis de röda ringarna i \autoref{fig:fresnelZones} är helt i fas och mellan de röda ringarna finns ljus som kommer in som har helt motsatt fas samt alla faser där imellan. För att förenkla bilden grupperar man in ytan i zoner över vilka fasen approximeras som konstant och tilldelas en av endast två direkt motsatta faser, dessa zoner kallas Fresnelzoner. På så sätt kan man dra mycket pricksäkra slutsatser bara genom att räkna hur många zoner av vardera sort som släpps igenom. \cite{pearsonIntroOpt}

\pgfmathsetmacro{\numFresnelWaves}{8}
\pgfmathsetmacro{\fresnelWavesDist}{0.1}
\pgfmathsetmacro{\leftRightDist}{2.5}

\begin{figure}[ht]
	\centering
	\begin{tikzpicture}[scale=2]
	
	\node[circle,fill=black,inner sep=0,minimum size=3] at (0,0) {}; % Draw the source
	\foreach \waveIdx in {1,...,\numFresnelWaves}
	{ % and numFresnelWaves waves spaced with fresnelWavesDist
		\draw (0, {-\fresnelWavesDist*\waveIdx}) arc [radius={\fresnelWavesDist*\waveIdx}, start angle=-90, end angle=90]; % Waves move to the right +-90*.
		%\draw ({\fresnelWavesDist*\waveIdx/sqrt(2)}, {-\fresnelWavesDist*\waveIdx/sqrt(2)}) arc [radius={\fresnelWavesDist*\waveIdx}, start angle=-45, end angle=45]; % Waves move to the right +-45*.
	}
	
	% Draw the slit so that it covers 45* of the source's view.
	\draw[line width=0.75mm] ({\fresnelWavesDist*\numFresnelWaves/sqrt(2)}, {1.4*\fresnelWavesDist*\numFresnelWaves}) -- ({\fresnelWavesDist*\numFresnelWaves/sqrt(2)}, {\fresnelWavesDist*\numFresnelWaves/sqrt(2)}); % top half
	\draw[line width=0.25mm,red] ({\fresnelWavesDist*\numFresnelWaves/sqrt(2)}, {\fresnelWavesDist*\numFresnelWaves/sqrt(2)}) -- ({\fresnelWavesDist*\numFresnelWaves/sqrt(2)}, {-\fresnelWavesDist*\numFresnelWaves/sqrt(2)}); % emphasis on the aperture.
	\draw[line width=0.75mm] ({\fresnelWavesDist*\numFresnelWaves/sqrt(2)}, {-\fresnelWavesDist*\numFresnelWaves/sqrt(2)}) --({\fresnelWavesDist*\numFresnelWaves/sqrt(2)}, {-1.4*\fresnelWavesDist*\numFresnelWaves}); % lower half

	\pgfmathsetmacro{\Start}{ceil(\numFresnelWaves/sqrt(2))} % Only the last few wavefronts actually reach the aperture.
	\foreach \waveIdx in {\Start,...,\numFresnelWaves} % For all those that do
	{
		\pgfmathsetmacro{\R}{\fresnelWavesDist*sqrt(\waveIdx*\waveIdx - \numFresnelWaves*\numFresnelWaves/2)} % Calculate the radius of the wavefront at the aperture.
		\draw[dashed] ({\fresnelWavesDist*\numFresnelWaves/sqrt(2)}, {\R}) -- ({\leftRightDist*\fresnelWavesDist*\numFresnelWaves}, {\R}); % Connect the two images (upper line)
		\draw[dashed] ({\fresnelWavesDist*\numFresnelWaves/sqrt(2)}, {-\R}) -- ({\leftRightDist*\fresnelWavesDist*\numFresnelWaves}, {-\R}); % Connect the two images (lower line)
		\draw[red] ({\leftRightDist*\fresnelWavesDist*\numFresnelWaves}, 0) circle ({\R)}); % Draw the intersections of the wavefronts with the aperture.
	}
	
	\end{tikzpicture}
	\caption{Illustration av hur fresnelzoner uppkommer i en cirkulär öppning. Till vänster visas hur vågfronterna når öppningen efter olika lång sträcka och därmed olika fas. Till höger visas var vågfronterna skär den cirkulära öppningen, varje cirkel är då i fas. I Fraunhoferdiffraktion är ljuskällan så långt bort att alla vågfronterna når öppningen samtidigt utan fasskillnad.}
	\label{fig:fresnelZones}
\end{figure}

Utan hinder i vägen släpps alla zoner igenom och den resulterande amplituden på andra sidan kan vi då kalla för $A_0$. Men man kan också beskriva amplituden som en summa av alla Fresnelzoner med omväxlande tecken, då varannan zon har motsatt fas. Efter en analys av denna summa kan man komma fram till att den totala amplituden blir cirka halva den amplitud som endast första Fresnelzonen bidrar med. Detta ger den intressanta och oväntade konsekvensen att när man släcker ut den första zonen kommer de resterande zonerna tillsammans ha en nästan lika stor amplitud, men med motsatt fas, vilket syns som i liten ljus fläck i mitten av skuggan av ett cirkulärt objekt. Denna fläck kallas Poissons fläck.
\cite{pearsonIntroOpt}

För fallet med en rektangulär spalt beräknar \cite[pp.~340--342]{pearsonIntroOpt} en approximation till integralen i \eqref{eq:frKirInt} då variationerna av obliquity-faktorn och produkten $r r'$ försummas. Denna beräkning ger att intensiteten ges av

\begin{equation}
	I_p = I_0 \left\{\left(C(v_2) - C(v_1)\right)^2 + \left(S(v_2) - S(v_1)\right)^2\right\}
	\label{eq:rectApFre}
\end{equation}

där $v_1\equiv z_1\sqrt{\frac{2}{L\lambda}}$ så att $z_1$ är avståndet från den optiska axeln till den ena spaltkanten och $v_2\equiv z_2\sqrt{\frac{2}{L\lambda}}$ där $z_2$ är avståndet från den optiska axeln till den andra spaltkanten. $S(v)$ och $C(v)$ är Fresnels sinus- respektive cosinusintegral definierade genom

\begin{align}
	S(v) &= \int\limits_0^v \sin\left(\frac{\pi u^2}{2}\right) d u \\
	C(v) &= \int\limits_0^v \cos\left(\frac{\pi u^2}{2}\right) d u\text{.}
\end{align}

Dessa funktioner illustreras i \autoref{fig:cornuSpiral}.

\begin{figure}[ht]
	\centering
	\begin{tikzpicture}
	\begin{axis}[
			xlabel=$C(v)$,
			ylabel=$S(v)$,
            xmin=-1,xmax=1,
            ymin=-1,ymax=1,
            grid=both,
            ]
            \addplot[mark=none] table [y=Y] {fresnelc.txt};
    \end{axis}
	\end{tikzpicture}
	\caption{En plot av en Cornuspiral där x-koordinaten är $C(v)$ och y-koordinaten är $S(v)$. Amplituden på skärmen blir vektorn som förbinder de två punkterna $(C(v_1), S(v_1))$ och $(C(v_2), S(v_2))$ längs kurvan och intensiteten blir den vektorns längd i kvadrat.}
	\label{fig:cornuSpiral}
\end{figure}

För en egg går $v_2$ mot oändligheten och både $C(\infty)$ och $S(\infty)$ blir $\frac{1}{2}$. Då blir \eqref{eq:rectApFre}

\begin{equation}
	I_p = I_0 \left\{\left(\frac{1}{2} - C(v_1)\right)^2 + \left(\frac{1}{2} - S(v_1)\right)^2\right\}\text{.}
	\label{eq:diffEdge}
\end{equation}

\FloatBarrier

\subsection{Babinets princip}

Om ett objekt byts ut mot ett så kallat komplementärt objekt, som släpper igenom ljus där den ursprungliga inte gjorde och blockerar där den ursprungliga var genomskinlig, blir hela interferensmönstret likadant, fast med motsatt fas. Detta kallas Babinets princip och kan motiveras genom att tänka sig att om båda objekten var närvarande samtidigt borde allt släckas ut, men samtidigt borde effekten bara vara summan av det två objektens effekt. Om summan av två tal ska bli noll, måste de vara minus varandra, vilket motsvarar en fasförskjutning på $\pi$, men intensiteten förändras inte då den inte påverkas av teckenbytet.

\section{Metod}
  % De  olika  stegen  i  uppgiftens genomförande.  Till  exempel  val  av
  % algoritmer,  programspråk och  annan programvara,  undersökningsmetod,
  % statistiska  metoder. Där  valmöjligheter finns,  diskutera de  gjorda
  % valen.
  
  En laserstråle linjerades och kollimerades och riktades mot en skärm. Bakom skärmen placerades en kamera som kopplades in till ett program på en dator. En hållare som till exempel kan innehålla olika spaltsystem placerades på lämpligt avstånd från skärmen så att alla mönster blev av rimliga storlekar.
  För att mäta detta avstånd användes en dubbelspalt med kända mått och intensitetsfördelningen passades in på en teoretiskt beräknad kurva i programmet. Sedan placerades i tur och ordning en enkelspalt, en tråd, ett flerspaltsystem och en ställbar spalt på samma avstånd från skärmen och intensitetsfördelningarna mättes. Intensitetsfördelningarna passades sedan in över teoretiska intensitetsfördelningar så att relevanta parametrar kunde beräknas.
  
  Sedan togs utrustningen som kollimerade laserstrålen bort och den divergerande strålen läts belysa en cirkel, en ställbar spalt samt en egg. Diffraktionsmöstren fotograferades och för den ställbara spalten filmades förändringarna då spaltbredden förändrades.
  
  \subsection{Datorsimulering}
  
  För att kunna jämföra med vad teorin förutsäger skrevs ett antal skript i matlab som skulle simulera Fraunhofer- och Fresneldiffraktion. Fraunhoferdiffraktionen implementerades med hjälp av matlabs inbyggda FFT algoritm \lstinline{fft2} som beräknar tvådimensionella Fouriertransformer, vilket Fraunhoferdiffraktion kan beskrivas som enligt \eqref{eq:fraunFT}. Fresneldiffraktion implementerades för specialfallet med en egg genom funktionerna  \lstinline{fresnelc} och \lstinline{fresnels} med hjälp av \eqref{eq:diffEdge}. Även diffraktionsmönstret för ett gitter med godtyckligt antal spalter beräknades och för detta användes \eqref{eq:diffGrating}.

\section{Resultat}

I alla mätningar användes ett CCD-chip med ett begränsat exponeringsintervall. Intensitetsdatan är därmed normaliserad mellan $0$ och $1$, där $1$ representerar den maximala intensiteten som kan mätas av chippet.

\subsection{Mätning av spaltsystem i Fraunhoferregimen}

I \autoref{fig:dubbelspalt} presenteras den uppmätta intensitetsfördelningen i Fraunhoferregimen för en dubbelspalt med spaltavståndet \SI{100}{\micro\m} och spaltbredden \SI{250}{\micro\m}. Figuren innehåller även det förväntade teoretiska resultatet som beräknades med samma parametrar. Avståndet mellan spalt och skärm bestämdes sedan till \SI{686}{\milli\m},  detta avstånd hölls sedan fixt under resterande mätningar.

\FloatBarrier

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.75\linewidth]{Data/Figurer/dubbelspalt.eps}
	\includegraphics[width=0.5\linewidth]{Data/Figurer/dubbelspalt.png}
	\caption{Interferensmönstret för ett dubbelspaltssystem i Fraunhoferregimen. I figuren visas den experimentella och teoretiska intensitetsfördlningen på ett CCD-chip. Mätningen gjordes med spaltavståndet \SI{250}{\micro\meter} och spaltbredden \SI{100}{\micro\meter}. Avståndet mellan dubbelspalten och skärmen bestämdes till \SI{686}{\milli\meter}.}
	\label{fig:dubbelspalt}
\end{figure}

\FloatBarrier

Efter att avståndet till spalten  bestämts, kunde detta användas för att bestämma spaltavståndet i ett fyrspaltssystem. \autoref{fig:4spalt} visar den experimentella och teoretiska intensitetsfördelningen i Fraunhoferregimen för detta system. Spaltbredden var \SI{77.229}{\micro\m} och spaltavståndet bestämdes till \SI{254.28}{\micro\m}.

\FloatBarrier

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.75\linewidth]{Data/Figurer/4spalt.eps}
	\includegraphics[width=0.5\linewidth]{Data/Figurer/4spalt.png}
	\caption{Den experimentella och teoretiska intensitetsfördlningen på ett CCD-chip för ett fyrspaltssystem. Mätningen gjordes i Fraunhoferregimen med spaltbredden \SI{77.229}{\micro\meter} och spaltavståndet bestämdes till \SI{254.28}{\micro \meter}.}
	\label{fig:4spalt}
\end{figure}

\FloatBarrier

Samma mätning upprepades sedan för en enkelspalt. \autoref{fig:enkelspalt} presenterar den teoretiska och experimentella intensitetsfördelningen I Fraunhoferregimen för denna enkelspalt, varefter spaltbredden bestämdes till \SI{212.22}{\micro\m}.

\FloatBarrier

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.75\linewidth]{Data/Figurer/enkelspalt.eps}
	\includegraphics[width=0.5\linewidth]{Data/Figurer/enkelspalt.png}
	\caption{Diffraktionsmönstret för en enkelspalt. Figuren visar den teoretiska och experimentella intensitetsfördelning på ett CCD-chip, där spaltbredden bestämdes till \SI{212.22}{\micro\m}.}
	\label{fig:enkelspalt}
\end{figure}

\FloatBarrier

\autoref{fig:tradHogExpo} och \autoref{fig:tradLagExpo} visar intensitetsfördelningen som uppstår då en tråd med bredden \SI{212.22}{\micro\m} belyses, tillsammans med den teoretiska intensitetsfördelningen av en enkelspalt med samma bredd. I \autoref{fig:tradHogExpo} som är tagen med hög exponering är maxima av högre ordning synliga, medan de lägre är överexponerade. Motsatsen kan ses i \autoref{fig:tradLagExpo} där maxima av ordningen $-1, 0$ och $1$ precis är synliga.

\FloatBarrier

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.75\linewidth]{Data/Figurer/tradHogExpo.eps}
	\includegraphics[width=0.5\linewidth]{Data/Figurer/tradHogExpo.png}
	\caption{Diffraktionsmönstret för en tråd med bredden \SI{212.22}{\micro\m}. Bilden togs med hög exponering och i figuren är maxima av högre ordning synliga. Mätningen ritas här tillsammans med diffraktionsmönstret från en enkelspalt med samma bredd.}
	\label{fig:tradHogExpo}
\end{figure}

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.75\linewidth]{Data/Figurer/tradLagExpo.eps}
	\includegraphics[width=0.5\linewidth]{Data/Figurer/tradLagExpo.png}
	\caption{Diffraktionsmönstret för en tråd med bredden \SI{212.22}{\micro\m}. Bilden togs med låg exponering och i figuren är maxima av ordningarna $-1, 0$ och $1$ synliga. Mätningen ritas här tillsammans med diffraktionsmönstret från en enkelspalt med samma bredd.}
	\label{fig:tradLagExpo}
\end{figure}

\FloatBarrier

Intensitetsfördelningen som uppstår då en enkelspalt med spaltbredden \SI{212.22}{\micro\m} och en tråd av samma bred belyses samtidigt presenteras i \autoref{fig:trad+enkelspalt} tillsammans med den teoretiska intensitetsfördelningen av en enkelspalt med samma bredd. Genom mitten av interferensmönstret är en mörk region med låg intensitet syndlig, i både horisontal- och vertikalled.

\FloatBarrier

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.75\linewidth]{Data/Figurer/trad+enkelspalt.eps}
	\includegraphics[width=0.5\linewidth]{Data/Figurer/trad+enkelspalt.png}
	\caption{Interferensmönstret då en tråd med bredden \SI{212.22}{\micro\m} och en spalt av samma bredd belyses samtidigt. Genom mitten av mönstret är mörk region med låg intensitet synlig, i både horisontal- och vertikalled.}
	\label{fig:trad+enkelspalt}
\end{figure}

\FloatBarrier

\autoref{fig:variabelEnkelspalt1}, \autoref{fig:variabelEnkelspalt2} och \autoref{fig:variabelEnkelspalt3} visar intensitetsfördelningen i Fraunhoferregimen för en ställbar enkelspalt vid tre olika spaltbredder. För att bestämma spaltbredden justerades denna i den teoretiska intensitetsfördelningen så att mönstren stämmer överens. Detta resulterade i spaltbredderna \SI{153.289}{\micro\m}, \SI{111.2}{\micro\m} och \SI{69.5}{\micro\m}

\FloatBarrier

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.75\linewidth]{Data/Figurer/variabelEnkelspalt1.eps}
	\includegraphics[width=0.5\linewidth]{Data/Figurer/variabelEnkelspalt1.png}
	\caption{Intensitetsfördelningen i Fraunhoferregimen för en variabel enkelspalt med spaltbredden \SI{153.289}{\micro\m}.}
	\label{fig:variabelEnkelspalt1}
\end{figure}

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.75\linewidth]{Data/Figurer/variabelEnkelspalt1.eps}
	\includegraphics[width=0.5\linewidth]{Data/Figurer/variabelEnkelspalt2.png}
	\caption{Intensitetsfördelningen i Fraunhoferregimen för en variabel enkelspalt med spaltbredden \SI{111.2}{\micro\m}.}
	\label{fig:variabelEnkelspalt2}
\end{figure}

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.75\linewidth]{Data/Figurer/variabelEnkelspalt2.eps}
	\includegraphics[width=0.5\linewidth]{Data/Figurer/variabelEnkelspalt2.png}
	\caption{Intensitetsfördelningen i Fraunhoferregimen för en variabel enkelspalt med spaltbredden \SI{69.5}{\micro\m}.}
	\label{fig:variabelEnkelspalt3}
\end{figure}

\FloatBarrier

\subsection{Mätning av intensitetsfördelning i Fresnelregimen}

Diffraktionen från en egg presenteras i \autoref{fig:edge}. I figuren syns ett tydlig spaltmönster som avtar i intensitet med avståndet från eggen.

\FloatBarrier

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.75\linewidth]{Data/Figurer/edge.eps}
	\includegraphics[width=0.5\linewidth]{Data/Figurer/edge.png}
	\caption{Den experimentella intensitetsfördelningen för ljus som belyser en egg.}
	\label{fig:edge}
\end{figure}

\FloatBarrier

\autoref{fig:fresnelEnkel} visar en bildsekvens på hur diffraktionsmönstret i Fresnelregimen ändras för minskad spaltbredd, där spaltbredden minskar från vänster till höger. I den sista bilden ses ett mönster mer likt Fraunhoferdiffraktion.

\FloatBarrier

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.24\linewidth]{Data/Figurer/fresnelEnkel1.png}
	\includegraphics[width=0.24\linewidth]{Data/Figurer/fresnelEnkel2.png}
	\includegraphics[width=0.24\linewidth]{Data/Figurer/fresnelEnkel3.png}
	\includegraphics[width=0.24\linewidth]{Data/Figurer/fresnelEnkel4.png}
	\caption{Diffraktionsmönster för en variabel enkelspalt i Fresnelregmien. Spaltbredden minskar från vänster till höger.}
	\label{fig:fresnelEnkel}
\end{figure}

\FloatBarrier

I \autoref{fig:poissonsFlack} ses det diffraktionsmönster som uppstår då en cirkelskiva belsyses. I mitten av den cirkulära skuggan syns vad som kallas Poissons fläck.

\FloatBarrier

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.5\linewidth]{Data/Figurer/poissonsflack.jpg}
	\caption{Diffraktionsmönster bakom ett cirkulär hinder. I mitten syns vad som kallas Poissons fläck.}
	\label{fig:poissonsFlack}
\end{figure}

\FloatBarrier

\subsection{Datorsimuleringar}

Följande simuleringar gjordes i \textsc{MATLAB} och koden återfinns i \autoref{apx:code}.

\autoref{fig:simuleringEgg} illustrerar intensitetsfördleningen och det diffraktionsmönster som uppstår då ljus belyser en egg. I simuleringen sattes avståndet från ljuskällan till eggen och från eggen till samma värde som för våglängden.

\FloatBarrier

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.5\linewidth]{Data/Figurer/simuleringEgg.eps}
	\caption{Den simulerade intensitetsfördelningen för ljus som belyser en egg. Koden som genererade denna figur återfinns i \autoref{apx:code}}
	\label{fig:simuleringEgg}
\end{figure}

\FloatBarrier

En numerisk approximation av Fraunhoferdiffraktionen för en dubbelspalt återfinns i \autoref{fig:simuleringDubbelspalt}. Spalten som simulerades var rektangulär med sin längre sida i vertikalled. 

\FloatBarrier

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.5\linewidth]{Data/Figurer/simuleringDubbelspalt.eps}
	\caption{Diffraktionsmönster för en dubbelspalt beräknad med Fouriertransform. Spalterna är mycket högre än de är breda. Koden som genererade denna figur återfinns i \autoref{apx:code}}
	\label{fig:simuleringDubbelspalt}
\end{figure}

\FloatBarrier

\autoref{fig:simulering4Spalt} visar den teoretiska intensitetsfördleningen för Fraunhoferdiffraktionen av ett 4-spaltssystem. Mellan två principalmax kan två stycken bimax ses.

\FloatBarrier

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.5\linewidth]{Data/Figurer/simulering4Spalt.eps}
	\caption{Teoretisk diffraktionsmönster för ett 4-spaltssystem beräknat med \eqref{eq:diffGrating}. Koden som genererade denna figur återfinns i \autoref{apx:code}}
	\label{fig:simulering4Spalt}
\end{figure}

\FloatBarrier

En simulering av Babinets princip kan ses i \autoref{fig:simuleringBabinet}. I bilden längst till vänster ses intensitetsfördelningen för ett objekt där \SI{0.1}{\percent} av pixlarna släpper igenom ljus, dessa pixlar placerades ut slumpmässigt. I mittenfiguren ses komplimentet till föregående figur och i figuren längst till höger ses intensitetsfördleningen av deras summa.

\FloatBarrier

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.32\linewidth]{Data/Figurer/simuleringBabinet1.eps}
	\includegraphics[width=0.32\linewidth]{Data/Figurer/simuleringBabinet2.eps}
	\includegraphics[width=0.32\linewidth]{Data/Figurer/simuleringBabinet3.eps}
	\caption{Från vänster till höger: intensitetsfördelningen för ett objekt som skapats så att \SI{0.1}{\percent} av pixlarna släpper igenom ljus, intensitetsfördelningen för det föregåendes komplement samt intensitetsfördelningen av deras summa. Koden som genererade dessa figurer återfinns i \autoref{apx:code}}
	\label{fig:simuleringBabinet}
\end{figure}

\FloatBarrier

\section{Diskussion}
  %Är resultaten rimliga? Vad hade kunnat göras annorlunda?
  
  Alla diffraktionsmönster orsakade av enkelspalter stämmer mycket väl överens med de teoretiska kurvorna och då spaltbredden varierades i \autoref{fig:variabelEnkelspalt1}, \autoref{fig:variabelEnkelspalt2} och \autoref{fig:variabelEnkelspalt3} kan man tydligt se hur diffraktionsmönstret sprids ut när spalten minskar i storlek och även \autoref{fig:enkelspalt} passar in i mönstret eftersom diffraktionsmönstret är mindre och spalten som givit upphov till den större.
  
  Enligt Babinets princip borde en tråd generera samma diffraktionsmönster som en enkelspalt med samma bredd, men då den centrala toppen var så ljusstark var det svårt att påvisa detta. I \autoref{fig:tradHogExpo} kan man dock ana toppar där de borde vara enligt den teoretiska kurvan för en enkelspalt medan det i \autoref{fig:tradLagExpo} nästan bara syns ett centralmaximum. I \autoref{fig:trad+enkelspalt} belyses både spalt och tråd och man ser tydligare att topparna av högre ordning hamnar på precis samma ställe. Dessutom syns fasförskjutningen då de två mönstren tar ut varandra i mitten, vilket innebär att de har precis motsatt fas. Babinets princip fungerar alltså väl i det här sammanhanget förutom precis i mitten av diffraktionsmönstret där tråden har mycket högre intensitet.
  
  När spaltsystem med fler spalter användes blev bilderna mer otydliga, men de första toppar passa ändå mycket väl in med de teoretiska kurvorna och speciellt i \autoref{fig:dubbelspalt} kan man se ett bimaximum mellan varje par av huvudmax, medan det i \autoref{fig:4spalt} är mer otydligt.
  
  Den uppmätta Frenseldiffraktionen från en egg i \autoref{fig:edge} stämmer väl överens med det simulerade mönstret som ses i \autoref{fig:simuleringEgg}. Tydliga Fresnelzoner uppstår där ljuset från olika delar av vågfronten anländer i fas. Intensiteten oscillerar mellan att vara större och mindre än intensiteten för en oförhindrad vågrfront. Intensiteten oscillerar med avståndet från eggen, vilket kan förklaras genom att ljus från fler punktkällor kan adderas till varje punkt på skärmen. Detta resulterar även i att intensitetsskillnaden och därmed kontrasten mellan maxima och minima minskar.

  Intensitetsfördelningen för en enkelspalt i Fresnelregimen, som kan ses i \autoref{fig:fresnelEnkel}, kan förklaras genom att betrakta kanterna av spalten som en egg och addera de resulterande diffraktionsmönstrena som uppstår. När spaltbredden minskades, så minskades även bredden på det resulterande diffraktionsmönstret. Däremot, när spaltbredden görs tillräckligt liten övergår vi till Fraunhoferregimen, eftersom avståndet till spalten är stort i jämförelse med spaltbredden. Vågfronterna kan då betraktas som plana.
 
  Framkomsten av Poissons fläck i \autoref{fig:poissonsflack} där en cirkel belsyses med en divergent ljuskälla kan enklast förklaras med ljusets vågnatur. Enligt Huygens princip uppstår oändligt många punktkällor längs randen på cirkeln. Ljust från dessa punktkällor har samma optiska välglängd till centrumet av skärmen och anländer därmed i fas, vilket resulterar i en ljusfläck.

  Datorsimuleringen av en dubbelspalt i Fraunhoferregimen som kan ses i \autoref{fig:simuleringDubbelspalt} stämmer väl överens med experimentet som utfördes (se \autoref{fig:dubbelspalt}). Det är väldigt tydligt att mönstret som uppstår är en kombination av ett interferensmönster som berer på spaltavståndet och ett diffraktionsmönster som beror på spaltbredden.

  Samma sak gäller simuleringen av ett 4-spaltssytem i \autoref{fig:simulering4Spalt} där samma skärmavstånd, våglängd, skärmstorlek, spaltavstånd och spaltbredd användes som i experimentet (se \autoref{fig:4spalt}). Simuleringen överensstämmer därmed väldigt väl med experimentet som gjordes. Den enda skillnaden är att intensiteten för principalmaxen är större i simuleringen. Detta beror på att CCD-chippet som användes i kameran har ett relativt litet exponeringsintervall.

%\section{Slutsats}
  %En   sammanfattning  där   man  till   skillnad  från   den  inledande
  %sammanfattningen förutsätter  att läsaren har läst  rapporten, samt de
  %slutsatser man kan dra av det gjorda arbetet.
 
 \bibliography{bibliography}{}
 \bibliographystyle{plain}

\clearpage
\appendix

\section{Matlab code} \label{apx:code}

\FloatBarrier

  \begin{figure}[ht]
  \centering
  \begin{lstlisting}
% Definitions of variables.
p = 1; % Distance from source to edge.
q = 1; % Distance from screen to edge.
L = 1/(1/p + 1/q);
lambda = 1; % Wavelength.
screenSize = 20; % Width of screen.

% The position on the screen.
y = linspace(-screenSize/2,screenSize/2,1001);

% Calculate how far a straight line from the source to the screen passes the edge.
z = y*p/(q + p);

% Calculate the distance along the Cornu spiral.
v = z*sqrt(2/(L*lambda));

% Calculate the intensity.
intensity = ((0.5 - fresnelc(-v)).^2 + (0.5 - fresnels(-v)).^2)/2;
% Plot the intensity.
plot(y, intensity);
  \end{lstlisting}
  \caption{Kod för att simulera Fresneldiffraktion efter en egg. Diffraktionen beräknas med \eqref{eq:diffEdge}}
  \label{fig:FresnCode}
  \end{figure}

  \begin{figure}[ht]
  \centering
  \begin{lstlisting}
resolution = 1000; % The total number of pixels per side.
Nx = resolution/1000; % Slit width in pixels.
Ny = resolution/4; % Slit height in pixels.
d = resolution/50; % Distance between slits.
slit = zeros(resolution); % Init blocking all light.

% Set ones where the first slit is.
slit(resolution/2-Ny:resolution/2+Ny,resolution/2-Nx-d/2:resolution/2+Nx-d/2) = 1;
% Set ones where the second slit is.
slit(resolution/2-Ny:resolution/2+Ny,resolution/2-Nx+d/2:resolution/2+Nx+d/2) = 1;

% Fourier transform and center the low frequencies.
diff = fftshift(fft2(slit));
% Plot the intensity (scaled for better visibility).
image(abs(diff).^2/10);
  \end{lstlisting}
  \caption{Kod för att simulera Fraunhoferdiffraktion med hjälp av Fouriertransformer. \lstinline{ff2} beräknar en tvådimensionell Fouriertransform, vilket enligt \eqref{eq:fraunFT} precis är Fraunhoferdiffraktion.}
  \label{fig:fftFraunCode}
  \end{figure}

  \begin{figure}[ht]
  \centering
  \begin{lstlisting}
% Definitions of variables.
L = 0.686; % Distance to screen.
lambda = 404e-9; % Wavelength.
screenSize = 0.034; % Width of screen.
d = 0.25e-3; % Grating constant.
b = 0.077e-3; % Size of a single slit.
N = 4; % Number of slits.

% The position on the screen.
y = linspace(-screenSize/2,screenSize/2,1001);

% The angle from the grating to the screen with small angle approximation.
theta = y/L;

% Intermidiate variables from lab instructions.
beta = 1/lambda*b*sin(theta);
gamma = beta*pi*d/b;

% Plot the intensity.
plot(y, (sinc(beta).*sin(N*gamma)./(sin(gamma))).^2);
  \end{lstlisting}
  \caption{Kod för att beräkna intensitetsfördelningen som uppkommer på grund av ett godtyckligt antal spalter med hjälp av den analytiskt beräknade ekvationen \eqref{eq:diffGrating}.}
  \label{fig:analyticalGratingCode}
  \end{figure}

\begin{figure}[ht]
	\centering
	\begin{lstlisting}
resolution = 1000; % The total number of pixels per side.
Nx = resolution/100; % Slit width in pixels.
Ny = resolution/100; % Slit height in pixels.

% Uncomment if you want to use a rectangular slit.
%slit = zeros(resolution);
%slit(resolution/2-Ny:resolution/2+Ny,resolution/2-Nx:resolution/2+Nx) = 1;

% Set 0.1% of the pixels transparent.
slit = floor(1.001*rand(resolution));

% Fourier transform and center the low frequencies.
diff1 = fftshift(fft2(slit));
% Plot the intensity (scaled for better visibility).
image(abs(diff1).^2/10);

% Fourier transform for the slits complement.
diff2 = fftshift(fft2(1 - slit));
% Plot the intensity from the complement, should be the same due to Babinet's principle.
image(abs(diff2).^2/10);

% Plot the sum of the amplitudes from the slits and their the complement, should be zero.
image(abs(diff1 + diff2).^2/10);
	\end{lstlisting}
	\caption{Kod för att illustrera Babinets princip. Koden fungerar i princip likadant som den i \autoref{fig:fftFraunCode}, men räknar även ut komlementets diffraktionsmönster.}
	\label{fig:babinetCode}
\end{figure}

\FloatBarrier

\end{document}
